var N=Object.defineProperty;var W=(a,t,s)=>t in a?N(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;var H=(a,t,s)=>(W(a,typeof t!="symbol"?t+"":t,s),s);import{S as L,i as R,s as T,e as w,k as G,c as p,a as _,d as m,n as M,b,f as E,D as v,a8 as C,t as j,g as I,h as J,L as Q,M as X,N as Z,x as V,u as z,l as P,r as x,w as $,a9 as tt,K as et,j as st,m as it,o as at,v as nt,aa as F,A as lt,B as S,ab as U,ac as A,E as ot,ad as rt,H as ct}from"./vendor-76a7eba6.js";import{r as ut}from"./singletons-12a22614.js";import{s as ft}from"./toast-dea46e40.js";const ht=ut,O=dt;async function dt(a,t){return ht.goto(a,t,[])}function K(a){let t,s,i,e,l,n,o,r,f,h=a[1]&&Y(a);const y=a[4].default,c=et(y,a,a[3],null);return{c(){t=w("div"),s=w("div"),i=G(),e=w("div"),h&&h.c(),l=G(),n=w("div"),c&&c.c(),this.h()},l(u){t=p(u,"DIV",{class:!0});var g=_(t);s=p(g,"DIV",{class:!0}),_(s).forEach(m),i=M(g),e=p(g,"DIV",{class:!0});var d=_(e);h&&h.l(d),l=M(d),n=p(d,"DIV",{class:!0});var D=_(n);c&&c.l(D),D.forEach(m),d.forEach(m),g.forEach(m),this.h()},h(){b(s,"class","modal-backdrop"),b(n,"class","text-sm"),b(e,"class","modal-content"),b(t,"class","modal")},m(u,g){E(u,t,g),v(t,s),v(t,i),v(t,e),h&&h.m(e,null),v(e,l),v(e,n),c&&c.m(n,null),o=!0,r||(f=C(s,"click",a[2]),r=!0)},p(u,g){u[1]?h?h.p(u,g):(h=Y(u),h.c(),h.m(e,l)):h&&(h.d(1),h=null),c&&c.p&&(!o||g&8)&&Q(c,y,u,u[3],o?Z(y,u[3],g,null):X(u[3]),null)},i(u){o||(V(c,u),o=!0)},o(u){z(c,u),o=!1},d(u){u&&m(t),h&&h.d(),c&&c.d(u),r=!1,f()}}}function Y(a){let t,s;return{c(){t=w("div"),s=j(a[1]),this.h()},l(i){t=p(i,"DIV",{class:!0});var e=_(t);s=I(e,a[1]),e.forEach(m),this.h()},h(){b(t,"class","text-center text-lg font-semibold mb-2")},m(i,e){E(i,t,e),v(t,s)},p(i,e){e&2&&J(s,i[1])},d(i){i&&m(t)}}}function mt(a){let t,s,i=a[0]&&K(a);return{c(){i&&i.c(),t=P()},l(e){i&&i.l(e),t=P()},m(e,l){i&&i.m(e,l),E(e,t,l),s=!0},p(e,[l]){e[0]?i?(i.p(e,l),l&1&&V(i,1)):(i=K(e),i.c(),V(i,1),i.m(t.parentNode,t)):i&&(x(),z(i,1,1,()=>{i=null}),$())},i(e){s||(V(i),s=!0)},o(e){z(i),s=!1},d(e){i&&i.d(e),e&&m(t)}}}function gt(a,t,s){let{$$slots:i={},$$scope:e}=t,{show:l=!1}=t,{title:n}=t;const o=tt();function r(){o("close")}return a.$$set=f=>{"show"in f&&s(0,l=f.show),"title"in f&&s(1,n=f.title),"$$scope"in f&&s(3,e=f.$$scope)},[l,n,r,e,i]}class vt extends L{constructor(t){super();R(this,t,gt,mt,T,{show:0,title:1})}}function wt(a){let t,s,i,e,l,n,o,r,f,h,y;return{c(){t=w("p"),s=j("You should save them in Gist or other file services. Do you still want to continue?"),i=G(),e=w("div"),l=w("a"),n=j("Cancel"),o=G(),r=w("a"),f=j("OK"),this.h()},l(c){t=p(c,"P",{});var u=_(t);s=I(u,"You should save them in Gist or other file services. Do you still want to continue?"),u.forEach(m),i=M(c),e=p(c,"DIV",{class:!0});var g=_(e);l=p(g,"A",{});var d=_(l);n=I(d,"Cancel"),d.forEach(m),o=M(g),r=p(g,"A",{class:!0});var D=_(r);f=I(D,"OK"),D.forEach(m),g.forEach(m),this.h()},h(){b(r,"class","text-gray-500"),b(e,"class","modal-footer")},m(c,u){E(c,t,u),v(t,s),E(c,i,u),E(c,e,u),v(e,l),v(l,n),v(e,o),v(e,r),v(r,f),h||(y=[C(l,"click",A(a[2])),C(r,"click",A(a[3]))],h=!0)},p:ot,d(c){c&&m(t),c&&m(i),c&&m(e),h=!1,rt(y)}}}function pt(a){let t,s,i,e,l;return e=new vt({props:{show:a[1],title:"Your changes will be lost!",$$slots:{default:[wt]},$$scope:{ctx:a}}}),e.$on("close",a[2]),{c(){t=w("div"),i=G(),st(e.$$.fragment),this.h()},l(n){t=p(n,"DIV",{class:!0}),_(t).forEach(m),i=M(n),it(e.$$.fragment,n),this.h()},h(){b(t,"class",s=a[4].class)},m(n,o){E(n,t,o),a[9](t),E(n,i,o),at(e,n,o),l=!0},p(n,[o]){(!l||o&16&&s!==(s=n[4].class))&&b(t,"class",s);const r={};o&2&&(r.show=n[1]),o&8192&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){l||(V(e.$$.fragment,n),l=!0)},o(n){z(e.$$.fragment,n),l=!1},d(n){n&&m(t),a[9](null),n&&m(i),nt(e,n)}}}function _t(a,t,s){let i,{mm:e}=t,{dirty:l}=t,{showBrand:n=!1}=t,{isFull:o=!1}=t,r=!1;const f=new F;f.setBrand(n),f.register({id:"repl",title:"Open in REPL",content:F.icon("M4 5v10h12v-10zM6 7v6h3v-6zM14 7v6h-3v-6z"),onClick:u}),f.register({id:"full",title:"Full page view",content:F.icon("M4 9v-4h4v2h-2v2zM4 11v4h4v-2h-2v-2zM16 9v-4h-4v2h2v2zM16 11v4h-4v-2h2v-2z"),onClick:h}),f.setItems(["zoomIn","zoomOut","fit",o?"repl":"full"]),lt(()=>{i.append(f.render())});function h(){l?s(1,r=!0):c()}function y(){s(1,r=!1)}function c(){O("/full"+window.location.hash)}function u(){O("/repl"+window.location.hash)}function g(d){ct[d?"unshift":"push"](()=>{i=d,s(0,i)})}return a.$$set=d=>{s(4,t=S(S({},t),U(d))),"mm"in d&&s(5,e=d.mm),"dirty"in d&&s(6,l=d.dirty),"showBrand"in d&&s(7,n=d.showBrand),"isFull"in d&&s(8,o=d.isFull)},a.$$.update=()=>{a.$$.dirty&32&&f.attach(e)},t=U(t),[i,r,y,c,t,e,l,n,o,g]}class It extends L{constructor(t){super();R(this,t,_t,pt,T,{mm:5,dirty:6,showBrand:7,isFull:8})}}const k=class{constructor(t,s){this.type=t,this.data=s,this.desc=k.descriptions[t]||"Unknown"}isValidGist(){return this.type==="gist"&&/^\w+\//.test(this.data)}asUrl(){switch(this.type){case"gist":if(!this.isValidGist())throw new Error("Gist owner is missing");const[t,s]=this.data.split(":");return`https://gist.githubusercontent.com/${t}/raw/${s||"markmap.md"}`;case"github":const[i,e]=this.data.split(":"),[l,n]=i.split("@");return`https://raw.githubusercontent.com/${l}/${n||"main"}/${e||"README.md"}`;default:return this.data}}asData(){switch(this.type){case"gist":case"github":return`${this.type}:${this.data}`;default:return this.data}}async load(){const t=await this.asUrl(),s=await fetch(t);return q(s),s.text()}static parseSync(t){if(t instanceof k)return t;let s,i;for(const e of["gist","github"])if(t.startsWith(`${e}:`)){s=e,i=t.slice(e.length+1);break}if(!s){const e=new URL(t);if(e.origin==="https://raw.githubusercontent.com"){const[,l,n,o,...r]=e.pathname.split("/");s="github",i=[`${l}/${n}`,o&&`@${o}`,r.length&&`:${r.join("/")}`].filter(Boolean).join("")}else if(e.origin==="https://gist.githubusercontent.com"||e.origin==="https://gist.github.com"){const[,l,n,o,...r]=e.pathname.split("/");s="gist",i=[`${l}/${n}`,r.length&&`${r.join("/")}`].filter(Boolean).join(":")}}return s||(s=/^https?:\/\/./.test(t)&&"url",i=t),new k(s,i)}static async parse(t){const s=k.parseSync(t);if(s.type==="gist"&&!s.isValidGist()){const[i]=s.data.split(":"),e=await Et(i);s.data=`${e}/${s.data}`}return s}};let B=k;H(B,"descriptions",{gist:"GitHub Gist",github:"GitHub Raw",url:"URL"});const bt=B.parseSync("gist:gera2ld/af76a4c245b302206b16aec503dbe07b");function yt(a){return a.replace(/[<&]/g,t=>({"<":"&lt;","&":"&amp;"})[t])}function q(a){if(!a.ok)throw new TypeError(`Failed to fetch, got response "${a.status} ${a.statusText}"`);return a}async function Et(a){const t=await fetch(`https://api.github.com/gists/${a}`,{headers:{Accept:"application/vnd.github.v3+json"}});return q(t),(await t.json()).owner.login}async function kt(a){return(await B.parse(a)).load()}function Dt(a){let t;async function s(){const i={};t=i;const e=new URLSearchParams(window.location.hash.slice(1));let l=e.get("gist");const n=e.get("d");if(l&&!n){l.includes(":")||(l=`gist:${l}`);const f=`#?d=${l}`;await Promise.resolve(),window.location.hash=f;return}let o,r;try{r=await kt(n||bt)}catch(f){o=f}if(i===t&&(r&&a(r),o))if(o.name==="TypeError"&&/failed to fetch/i.test(o.message))ft({title:"Failed to fetch",html:['<div class="mt-1">Please check your network and resource</div>',n&&`<div class="mt-1 text-xs text-gray-600">${yt(n)}</div>`].filter(Boolean).join("")});else throw o}return s}function zt(a){const t=Dt(a);return window.addEventListener("hashchange",t),t(a),()=>window.removeEventListener("hashchange",t)}export{vt as M,It as T,B as U,bt as d,kt as l,zt as s};
